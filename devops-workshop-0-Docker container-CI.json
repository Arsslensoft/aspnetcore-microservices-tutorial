{"options":[{"enabled":true,"definition":{"id":"5d58cc01-7c75-450c-be18-a388ddb129ec"},"inputs":{"branchFilters":"[\"+refs/heads/*\"]","additionalFields":"{}"}},{"enabled":false,"definition":{"id":"a9db38f9-9fdc-478c-b0f9-464221e58316"},"inputs":{"workItemType":"Issue","assignToRequestor":"true","additionalFields":"{}"}}],"variables":{"system.debug":{"value":"false","allowOverride":true}},"retentionRules":[{"branches":["+refs/heads/*"],"artifacts":[],"artifactTypesToDelete":["FilePath","SymbolStore"],"daysToKeep":10,"minimumToKeep":1,"deleteBuildRecord":true,"deleteTestResults":true}],"properties":{},"tags":[],"_links":{"self":{"href":"https://dev.azure.com/gomycode-devops-workshop/f292e9ee-f3e1-4051-ac4e-287720c50987/_apis/build/Definitions/1?revision=26"},"web":{"href":"https://dev.azure.com/gomycode-devops-workshop/f292e9ee-f3e1-4051-ac4e-287720c50987/_build/definition?definitionId=1"},"editor":{"href":"https://dev.azure.com/gomycode-devops-workshop/f292e9ee-f3e1-4051-ac4e-287720c50987/_build/designer?id=1&_a=edit-build-definition"},"badge":{"href":"https://dev.azure.com/gomycode-devops-workshop/f292e9ee-f3e1-4051-ac4e-287720c50987/_apis/build/status/1"}},"buildNumberFormat":"$(date:yyyyMMdd)$(rev:.r)","jobAuthorizationScope":1,"jobTimeoutInMinutes":60,"jobCancelTimeoutInMinutes":5,"process":{"phases":[{"steps":[{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build services","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6975e2d1-96d3-4afc-8a41-498b5d34ea19","versionSpec":"0.*","definitionType":"task"},"inputs":{"containerregistrytype":"Container Registry","dockerRegistryEndpoint":"95230859-b6e3-45dd-af03-c7dc6abf8fa2","azureSubscriptionEndpoint":"","azureContainerRegistry":"","dockerComposeFile":"docker-compose.yml","additionalDockerComposeFiles":"","dockerComposeFileArgs":"","projectName":"devops-workshop","qualifyImageNames":"true","action":"Build services","additionalImageTags":"","includeSourceTags":"false","includeLatestTag":"true","buildImages":"true","serviceName":"","containerName":"","ports":"","workDir":"","entrypoint":"","containerCommand":"","detached":"true","abortOnContainerExit":"true","imageDigestComposeFile":"$(Build.StagingDirectory)/docker-compose.images.yml","removeBuildOptions":"false","baseResolveDirectory":"","outputDockerComposeFile":"$(Build.StagingDirectory)/docker-compose.yml","dockerComposeCommand":"","dockerHostEndpoint":"","nopIfNoDockerComposeFile":"false","requireAdditionalDockerComposeFiles":"false","cwd":"$(System.DefaultWorkingDirectory)"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Push services","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6975e2d1-96d3-4afc-8a41-498b5d34ea19","versionSpec":"0.*","definitionType":"task"},"inputs":{"containerregistrytype":"Container Registry","dockerRegistryEndpoint":"95230859-b6e3-45dd-af03-c7dc6abf8fa2","azureSubscriptionEndpoint":"","azureContainerRegistry":"","dockerComposeFile":"docker-compose.yml","additionalDockerComposeFiles":"","dockerComposeFileArgs":"","projectName":"devops-workshop","qualifyImageNames":"true","action":"Push services","additionalImageTags":"","includeSourceTags":"false","includeLatestTag":"true","buildImages":"true","serviceName":"","containerName":"","ports":"","workDir":"","entrypoint":"","containerCommand":"","detached":"true","abortOnContainerExit":"true","imageDigestComposeFile":"$(Build.StagingDirectory)/docker-compose.images.yml","removeBuildOptions":"false","baseResolveDirectory":"","outputDockerComposeFile":"$(Build.StagingDirectory)/docker-compose.yml","dockerComposeCommand":"","dockerHostEndpoint":"","nopIfNoDockerComposeFile":"false","requireAdditionalDockerComposeFiles":"false","cwd":"$(System.DefaultWorkingDirectory)"}},{"environment":{},"enabled":true,"continueOnError":true,"alwaysRun":false,"displayName":"kubectl delete","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"cbc316a2-586f-4def-be79-488a1f503564","versionSpec":"1.*","definitionType":"task"},"inputs":{"connectionType":"Kubernetes Service Connection","kubernetesServiceEndpoint":"ab5e1dc8-0013-4abd-be99-aac55a891618","azureSubscriptionEndpoint":"","azureResourceGroup":"","kubernetesCluster":"","namespace":"devops-workshop","command":"delete","useConfigurationFile":"true","configurationType":"configuration","configuration":"deploy.yml","inline":"apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2\nkind: Deployment\nmetadata:\n  name: products\n  namespace: devops-workshop\nspec:\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: products\n  replicas: 3 # tells deployment to run 1 pods matching the template\n  template: # create pods using pod definition in this template\n    metadata:\n      labels:\n        app: products\n    spec:\n      containers:\n        - name: products\n          image: \"docker.gomycode.tn:443/devops-workshop/products:latest\"\n          imagePullPolicy: Always\n          ports:\n            - containerPort: 5000\n      imagePullSecrets:\n        - name: mysecret\n\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: products\n  namespace: devops-workshop\n  labels:\n    app: products\nspec:\n  ports:\n    - name: http\n      port: 5000\n      protocol: TCP\n      targetPort: 5000\n  selector:\n    app: products\n  type: ClusterIP\n\n---\napiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2\nkind: Deployment\nmetadata:\n  name: categories\n  namespace: devops-workshop\nspec:\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: categories\n  replicas: 3 # tells deployment to run 1 pods matching the template\n  template: # create pods using pod definition in this template\n    metadata:\n      labels:\n        app: categories\n    spec:\n      containers:\n        - name: categories\n          image: \"docker.gomycode.tn:443/devops-workshop/categories:latest\"\n          imagePullPolicy: Always\n          ports:\n            - containerPort: 5000\n      imagePullSecrets:\n        - name: mysecret\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: categories\n  namespace: devops-workshop\n  labels:\n    app: categories\nspec:\n  ports:\n    - name: http\n      port: 5000\n      protocol: TCP\n      targetPort: 5000\n  selector:\n    app: categories\n  type: ClusterIP\n\n---\napiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2\nkind: Deployment\nmetadata:\n  name: gateway\n  namespace: devops-workshop\nspec:\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: gateway\n  replicas: 3 # tells deployment to run 1 pods matching the template\n  template: # create pods using pod definition in this template\n    metadata:\n      labels:\n        app: gateway\n    spec:\n      containers:\n        - name: gateway\n          image: \"docker.gomycode.tn:443/devops-workshop/gateway:latest\"\n          imagePullPolicy: Always\n          ports:\n            - containerPort: 5000\n      imagePullSecrets:\n        - name: mysecret\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: gateway\n  namespace: devops-workshop\n  labels:\n    app: gateway\nspec:\n  ports:\n    - name: http\n      port: 5000\n      protocol: TCP\n      targetPort: 5000\n  selector:\n    app: gateway\n  type: ClusterIP\n","arguments":"","secretType":"dockerRegistry","secretArguments":"","containerRegistryType":"Container Registry","dockerRegistryEndpoint":"95230859-b6e3-45dd-af03-c7dc6abf8fa2","azureSubscriptionEndpointForSecrets":"","azureContainerRegistry":"","secretName":"","forceUpdate":"false","configMapName":"","forceUpdateConfigMap":"false","useConfigMapFile":"false","configMapFile":"","configMapArguments":"","versionOrLocation":"version","versionSpec":"1.13.2","checkLatest":"false","specifyLocation":"","cwd":"$(System.DefaultWorkingDirectory)","outputFormat":"json"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"kubectl apply","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"cbc316a2-586f-4def-be79-488a1f503564","versionSpec":"1.*","definitionType":"task"},"inputs":{"connectionType":"Kubernetes Service Connection","kubernetesServiceEndpoint":"ab5e1dc8-0013-4abd-be99-aac55a891618","azureSubscriptionEndpoint":"","azureResourceGroup":"","kubernetesCluster":"","namespace":"devops-workshop","command":"apply","useConfigurationFile":"true","configurationType":"configuration","configuration":"deploy.yml","inline":"apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2\nkind: Deployment\nmetadata:\n  name: products\n  namespace: devops-workshop\nspec:\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: products\n  replicas: 3 # tells deployment to run 1 pods matching the template\n  template: # create pods using pod definition in this template\n    metadata:\n      labels:\n        app: products\n    spec:\n      containers:\n        - name: products\n          image: \"docker.gomycode.tn:443/devops-workshop/products:latest\"\n          imagePullPolicy: Always\n          ports:\n            - containerPort: 5000\n      imagePullSecrets:\n        - name: mysecret\n\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: products\n  namespace: devops-workshop\n  labels:\n    app: products\nspec:\n  ports:\n    - name: http\n      port: 5000\n      protocol: TCP\n      targetPort: 5000\n  selector:\n    app: products\n  type: ClusterIP\n\n---\napiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2\nkind: Deployment\nmetadata:\n  name: categories\n  namespace: devops-workshop\nspec:\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: categories\n  replicas: 3 # tells deployment to run 1 pods matching the template\n  template: # create pods using pod definition in this template\n    metadata:\n      labels:\n        app: categories\n    spec:\n      containers:\n        - name: categories\n          image: \"docker.gomycode.tn:443/devops-workshop/categories:latest\"\n          imagePullPolicy: Always\n          ports:\n            - containerPort: 5000\n      imagePullSecrets:\n        - name: mysecret\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: categories\n  namespace: devops-workshop\n  labels:\n    app: categories\nspec:\n  ports:\n    - name: http\n      port: 5000\n      protocol: TCP\n      targetPort: 5000\n  selector:\n    app: categories\n  type: ClusterIP\n\n---\napiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2\nkind: Deployment\nmetadata:\n  name: gateway\n  namespace: devops-workshop\nspec:\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: gateway\n  replicas: 3 # tells deployment to run 1 pods matching the template\n  template: # create pods using pod definition in this template\n    metadata:\n      labels:\n        app: gateway\n    spec:\n      containers:\n        - name: gateway\n          image: \"docker.gomycode.tn:443/devops-workshop/gateway:latest\"\n          imagePullPolicy: Always\n          ports:\n            - containerPort: 5000\n      imagePullSecrets:\n        - name: mysecret\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: gateway\n  namespace: devops-workshop\n  labels:\n    app: gateway\nspec:\n  ports:\n    - name: http\n      port: 5000\n      protocol: TCP\n      targetPort: 5000\n  selector:\n    app: gateway\n  type: ClusterIP\n","arguments":"","secretType":"dockerRegistry","secretArguments":"","containerRegistryType":"Container Registry","dockerRegistryEndpoint":"95230859-b6e3-45dd-af03-c7dc6abf8fa2","azureSubscriptionEndpointForSecrets":"","azureContainerRegistry":"","secretName":"","forceUpdate":"false","configMapName":"","forceUpdateConfigMap":"false","useConfigMapFile":"false","configMapFile":"","configMapArguments":"","versionOrLocation":"version","versionSpec":"1.13.2","checkLatest":"false","specifyLocation":"","cwd":"$(System.DefaultWorkingDirectory)","outputFormat":"json"}}],"name":"Agent job 1","refName":"Job_1","condition":"succeeded()","target":{"executionOptions":{"type":0},"allowScriptsAuthAccessOption":false,"type":1},"jobAuthorizationScope":1}],"type":1},"repository":{"properties":{"cleanOptions":"0","labelSources":"0","labelSourcesFormat":"$(build.buildNumber)","reportBuildStatus":"true","gitLfsSupport":"false","skipSyncSource":"false","checkoutNestedSubmodules":"false","fetchDepth":"0"},"id":"b61f614c-70c5-4f25-a74d-762d9edc2eb2","type":"TfsGit","name":"devops-workshop-0","url":"https://gomycode-devops-workshop@dev.azure.com/gomycode-devops-workshop/devops-workshop-0/_git/devops-workshop-0","defaultBranch":"refs/heads/master","clean":"false","checkoutSubmodules":false},"processParameters":{},"quality":1,"authoredBy":{"displayName":"Arsslen","url":"https://spsprodweu1.vssps.visualstudio.com/Aa1b24663-c4f6-49d1-9444-e1cb9d7e20a5/_apis/Identities/ee5551b7-7ac3-4923-bac8-4c8d3e554336","_links":{"avatar":{"href":"https://dev.azure.com/gomycode-devops-workshop/_apis/GraphProfile/MemberAvatars/msa.OTU1YjEzNWItODczOC03MzdkLWI2YjgtOTE4ODE4ZDRiYzZh"}},"id":"ee5551b7-7ac3-4923-bac8-4c8d3e554336","uniqueName":"arsslens021@gmail.com","imageUrl":"https://dev.azure.com/gomycode-devops-workshop/_api/_common/identityImage?id=ee5551b7-7ac3-4923-bac8-4c8d3e554336","descriptor":"msa.OTU1YjEzNWItODczOC03MzdkLWI2YjgtOTE4ODE4ZDRiYzZh"},"drafts":[],"queue":{"_links":{"self":{"href":"https://dev.azure.com/gomycode-devops-workshop/_apis/build/Queues/7"}},"id":7,"name":"Hosted Ubuntu 1604","url":"https://dev.azure.com/gomycode-devops-workshop/_apis/build/Queues/7","pool":{"id":7,"name":"Hosted Ubuntu 1604","isHosted":true}},"id":1,"name":"devops-workshop-0-Docker container-CI","url":"https://dev.azure.com/gomycode-devops-workshop/f292e9ee-f3e1-4051-ac4e-287720c50987/_apis/build/Definitions/1?revision=26","uri":"vstfs:///Build/Definition/1","path":"\\","type":2,"queueStatus":0,"revision":26,"createdDate":"2019-03-19T17:17:20.173Z","project":{"id":"f292e9ee-f3e1-4051-ac4e-287720c50987","name":"devops-workshop-0","url":"https://dev.azure.com/gomycode-devops-workshop/_apis/projects/f292e9ee-f3e1-4051-ac4e-287720c50987","state":1,"revision":11,"visibility":0,"lastUpdateTime":"2019-03-19T14:25:36.510Z"}}